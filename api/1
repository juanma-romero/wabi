import https from 'https';
import fs from 'fs'

// Rutas a tus certificados (¡AJUSTA EL DOMINIO SI ES NECESARIO!)
const privateKeyPath = '/etc/letsencrypt/live/febo.lat/privkey.pem';
const certificatePath = '/etc/letsencrypt/live/febo.lat/fullchain.pem';

// Opciones para el servidor HTTPS
const options = {
  key: fs.readFileSync(privateKeyPath),
  cert: fs.readFileSync(certificatePath)
};

// Tu aplicación Node.js o un simple mensaje de prueba
const app = (req, res) => {
  res.writeHead(200, { 'Content-Type': 'text/plain' });
  res.end('¡Hola desde mi servidor HTTPS seguro en ' + req.headers.host + '!\n');
};

// Crear el servidor HTTPS
const PORT = 443; // Puerto estándar para HTTPS
https.createServer(options, app).listen(PORT, () => {
  console.log(`Servidor HTTPS escuchando en el puerto ${PORT}`);
  console.log(`Ahora puedes acceder a https://febo.lat`);
});

// Opcional: Redirigir tráfico HTTP a HTTPS (muy recomendado)
// Si quieres que el puerto 80 redirija al 443, necesitarías un servidor HTTP aparte
// o configurar tu Node.js para escuchar también en 80 y redirigir.
// Un ejemplo sencillo de redirección HTTP a HTTPS:
/*
const http = require('http');
http.createServer((req, res) => {
    res.writeHead(301, { "Location": "https://" + req.headers['host'] + req.url });
    res.end();
}).listen(80, () => {
    console.log('Servidor HTTP (redirección) escuchando en el puerto 80');
});
*/
